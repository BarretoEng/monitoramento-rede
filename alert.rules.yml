groups:
  - name: icmp_alerts
    rules:
      - alert: PingFailureRateWarning
        expr: (1 - avg_over_time(probe_success{job="icmp_ping"}[5m])) > 0.3
        for: 1m
        labels:
          severity: warning
        annotations:
          summary: "‚ö†Ô∏è Falha de ping elevada em {{ $labels.instance }}"
          description: "Mais de 30% das sondas falharam nos √∫ltimos 5 minutos para o alvo {{ $labels.instance }}."

      - alert: PingFailureRateCritical
        expr: (1 - avg_over_time(probe_success{job="icmp_ping"}[5m])) > 0.5
        for: 1m
        labels:
          severity: critical
        annotations:
          summary: "üö® Falha de ping cr√≠tica em {{ $labels.instance }}"
          description: "Mais de 50% das sondas falharam nos √∫ltimos 5 minutos para o alvo {{ $labels.instance }}."

  - name: http_alerts
    rules:
      - alert: HTTPDown
        expr: probe_success{job="blackbox_http"} == 0
        for: 1m
        labels:
          severity: critical
        annotations:
          summary: "üö® Site fora do ar: {{ $labels.instance }}"
          description: "O alvo {{ $labels.instance }} n√£o respondeu com sucesso √†s requisi√ß√µes HTTP."

      - alert: HTTPLatencyHigh
        expr: avg_over_time(probe_duration_seconds{job="blackbox_http"}[2m]) > 1
        for: 1m
        labels:
          severity: warning
        annotations:
          summary: "‚ö†Ô∏è Tempo de resposta alto em {{ $labels.instance }}"
          description: "O tempo m√©dio de resposta HTTP excedeu 1 segundo nos √∫ltimos 2 minutos para {{ $labels.instance }}."
